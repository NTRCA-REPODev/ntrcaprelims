<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Online Exam Portal</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="logo">📚 Exam Portal</h1>
            <a href="index.html" class="btn btn-outline">Back to Home</a>
        </header>

        <div id="profileContent" style="display: none;">
            <div class="profile-header card">
                <div class="profile-avatar">
                    <div class="avatar-circle" id="avatarCircle"></div>
                </div>
                <div class="profile-info">
                    <h2 id="profileName"></h2>
                    <p class="profile-district" id="profileDistrict"></p>
                    <p class="profile-joined" id="profileJoined"></p>
                </div>
            </div>

            <div class="profile-stats card">
                <h3>Your Statistics</h3>
                <div class="stats-grid" id="statsGrid">
                    <!-- Stats will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
    </div>

    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const userData = getUserData();
            if (!userData) {
                window.location.href = 'index.html';
                return;
            }

            loadProfile();
        });

        async function loadProfile() {
            try {
                showLoading();
                const profileData = await apiCall('/me', 'GET');
                hideLoading();
                displayProfile(profileData);
            } catch (error) {
                hideLoading();
                showAlert(error.message || 'Failed to load profile', 'error');
            }
        }

        function displayProfile(profileData) {
            // Display basic profile info
            document.getElementById('profileName').textContent = profileData.name;
            document.getElementById('profileDistrict').textContent = `📍 ${profileData.district}`;
            document.getElementById('profileJoined').textContent = 
                `Member since ${formatDate(new Date(profileData.createdAt))}`;

            // Create avatar with initials
            const initials = profileData.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('avatarCircle').textContent = initials;

            // For now, show basic stats
            document.getElementById('statsGrid').innerHTML = `
                <div class="stat-item">
                    <div class="stat-value">📊</div>
                    <div class="stat-label">Statistics</div>
                    <div class="stat-description">Coming Soon</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">🎯</div>
                    <div class="stat-label">Achievements</div>
                    <div class="stat-description">Coming Soon</div>
                </div>
            `;

            document.getElementById('profileContent').style.display = 'block';
        }
    </script>
</body>
</html>